<div class="dashboard-inner">
  
  <div class="page-header">
    <h2>Gesti√≥n de Usuarios</h2>
    <p class="subtitle">Administra los accesos y roles del sistema</p>
  </div>

  <div *ngIf="isLoading" class="loading-state">
    <p>Cargando datos...</p>
  </div>

  <div *ngIf="!isLoading && !isAdmin" class="access-denied">
    <h3>Acceso Restringido</h3>
    <br>
    <p>No tienes permisos para ver esta informaci√≥n.</p>
  </div>

  <div class="content-wrapper" *ngIf="!isLoading && isAdmin">
    
    <div class="card form-card">
      <div class="card-header">
        <h3>{{ isEditing ? 'Editar Usuario' : 'Nuevo Usuario' }}</h3>
      </div>
      <div class="card-body">
        <form (ngSubmit)="onSubmit()" #form="ngForm">
          
          <div class="form-group">
            <label>Nombre</label>
            <input type="text" [(ngModel)]="userForm.nombre" name="nombre" required placeholder="Nombre">
          </div>

          <div class="form-group">
            <label>Apellido</label>
            <input type="text" [(ngModel)]="userForm.apellido" name="apellido" required placeholder="Apellido">
          </div>

          <div class="form-group">
            <label>Correo</label>
            <input type="email" [(ngModel)]="userForm.correo" name="correo" required email placeholder="usuario@impro.com">
          </div>

          <div class="form-group" *ngIf="!isEditing">
            <label>Contrase√±a</label>
            <input type="password" [(ngModel)]="userForm.password" name="pass" required minlength="4" placeholder="****">
          </div>

          <div class="form-group">
            <label>Rol</label>
            <select [(ngModel)]="userForm.idRol" name="rol" required>
              <option [value]="1">Administrador</option>
              <option [value]="2">Operador</option>
            </select>
          </div>

          <div class="form-group checkbox-group" *ngIf="isEditing">
            <label>
              <input type="checkbox" [(ngModel)]="userForm.active" name="active"> 
              Usuario Activo
            </label>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-save" [disabled]="form.invalid">
              {{ isEditing ? 'Guardar' : 'Crear' }}
            </button>
            <button type="button" class="btn-cancel" (click)="resetForm()" *ngIf="isEditing">
              Cancelar
            </button>
          </div>

        </form>
      </div>
    </div>

    <div class="card table-card">
      <div class="card-header">
        <h3>Lista de Usuarios</h3>
      </div>
      <div class="card-body table-responsive">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre Completo</th>
              <th>Correo</th>
              <th>Rol</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users">
              <td>#{{ user.id }}</td>
              <td>{{ user.nombre }} {{ user.apellido }}</td>
              <td>{{ user.correo }}</td>
              <td>
                <span class="badge" [class.admin-badge]="user.rolNombre === 'ADMINISTRADOR'">
                  {{ user.rolNombre }}
                </span>
              </td>
              <td>
                <span [class]="user.active ? 'status-active' : 'status-inactive'">
                  {{ user.active ? 'Activo' : 'Inactivo' }}
                </span>
              </td>
              <td class="actions">
                <button (click)="editUser(user)" class="btn-icon edit" title="Editar">‚úèÔ∏è</button>
                <button (click)="deleteUser(user.id)" class="btn-icon delete" title="Eliminar">üóëÔ∏è</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>